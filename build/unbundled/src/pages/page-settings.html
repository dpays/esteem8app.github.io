<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">


<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../components/my-icons.html">
<link rel="import" href="../components/color-select.html">
<link rel="import" href="../api/steemjs/steem-set-websocket-url.html">
<link rel="import" href="../api/steemjs/steem-set-chain-name.html">
<link rel="import" href="../shared-styles.html">

</head><body><dom-module id="page-settings">

    <template>

        <style include="shared-styles">

            /* GENERAL */
            :host {
                min-height: calc(100% - 16px);
                margin: 0;
                position: absolute;
                width: 100%;
                margin-top: -16px;
                padding-top: 16px;
                padding-bottom: 16px;
                display: block;
                background-color: var(--app-primary-background-color);
            }

            /* CARDS */
            .settingsCards {
                max-width: 400px;
                margin-top: 80px;
                margin-bottom: 50px;
                margin-left: auto;
                margin-right: auto;
            }

            .settingsCards paper-card {
                margin-top: 16px;
                width: 100%;
                display: block;
                background-color: var(--app-secondary-background-color);
                color: var(--app-background-primary-text-color);
            }

            paper-card h2 {
                color: var(--app-secondary-color);
                padding: 16px;
                margin: 0;
            }

            .card-content div {
                width: 100%;
                height: 68px;
            }

            .vertical-middle {
                line-height: 68px;
            }

            .vertical-middle paper-toggle-button {
                margin-top: 24px;
            }

            paper-input-container {
                height: 48px;
            }

            paper-toggle-button {
                float: right;
                --paper-toggle-button-checked-bar-color: var(--app-secondary-color);
                --paper-toggle-button-checked-button-color:  var(--app-secondary-color);
                --paper-toggle-button-checked-ink-color:  var(--app-secondary-color);
            }

            paper-input, color-select {
                --paper-input-container-focus-color: var(--app-secondary-color);
                --paper-input-container-input-color: var(--app-background-primary-text-color);
                --paper-input-container-color: var(--app-background-secondary-text-color);
            }

            paper-dropdown-menu {
                --paper-input-container-focus-color: var(--app-secondary-color);
                --paper-input-container-input-color: var(--app-background-primary-text-color);
            }

            paper-card div a {
                color: var(--app-primary-color);
                text-decoration: none;
            }

            #resetSettingsButton {
                margin-top: 16px;
                margin-right: 0;
                margin-left: 0;
                margin-bottom: 0;
                float: right;
                color: var(--app-background-primary-text-color);
            }

        </style>

        
        <paper-toolbar class="mainToolbar">
            <paper-icon-button id="toggleDrawerMenu" on-tap="_openDrawer()" icon="my-icons:menu">
            </paper-icon-button>
            <div class="floatingToolbar">
                <span class="floatingToolbarTitle">
                    Settings
                </span>
            </div>
            <a href="/trending">
                <paper-icon-button icon="my-icons:explore"></paper-icon-button>
            </a>
        </paper-toolbar>

        
        <div class="settingsCards">

            <paper-card>
                <h2>User</h2>
                <div class="card-content">
                    <paper-input label="Username" value="{{settings.user.name}}">
                    </paper-input>
                    
                </div>
            </paper-card>

            <paper-card>
                <h2>Theme</h2>
                <div class="card-content">
                    <div>
                        <color-select label="Primary color" color="{{_primaryColor}}" text-color="{{_primaryTextColor}}">
                        </color-select>
                    </div>
                    <div>
                        <color-select label="Secondary color" color="{{_secondaryColor}}" text-color="{{_secondaryTextColor}}">
                        </color-select>
                    </div>
                    <div class="vertical-middle">
                        <span>Dark background</span>
                        <paper-toggle-button checked="{{_darkBackground}}"></paper-toggle-button>
                    </div>
                </div>
            </paper-card>

            <paper-card>
                <h2>Publications</h2>
                <div class="card-content">
                    <div>
                        <span>Show card content</span>
                        <paper-toggle-button checked="{{settings.display.showCardContent}}"></paper-toggle-button>
                    </div>
                    <div>
                        <span>Show card tags</span>
                        <paper-toggle-button checked="{{settings.display.showCardTags}}"></paper-toggle-button>
                    </div>
                    <div>
                        <span>Show card image</span>
                        <paper-toggle-button checked="{{settings.display.showCardImage}}"></paper-toggle-button>
                    </div>
                </div>
            </paper-card>

            <paper-card>
                <h2>Content</h2>
                <div class="card-content">
                    <div>
                        <paper-dropdown-menu label="Thumbnail resolution">
                            <paper-listbox class="dropdown-content" selected="{{settings.display.imageResolution}}" attr-for-selected="value">
                                <paper-item value="low">Low</paper-item>
                                <paper-item value="medium">Medium</paper-item>
                                <paper-item value="high">High</paper-item>
                            </paper-listbox>
                        </paper-dropdown-menu>
                    </div>
                    <div>
                        <paper-dropdown-menu label="Text align">
                            <paper-listbox class="dropdown-content" selected="{{settings.content.textAlign}}" attr-for-selected="value">
                                <paper-item value="left">Left</paper-item>
                                <paper-item value="justify">Justify</paper-item>
                                <paper-item value="right">Right</paper-item>
                            </paper-listbox>
                        </paper-dropdown-menu>
                    </div>
                    
                    <div>
                        <paper-dropdown-menu label="Emoji library">
                            <paper-listbox class="dropdown-content" selected="{{settings.content.emojiSheet}}" attr-for-selected="value">
                                <paper-item value="emojione">EmojiOne</paper-item>
                                <paper-item value="apple">Apple</paper-item>
                                <paper-item value="google">Google</paper-item>
                                <paper-item value="twitter">Twitter</paper-item>
                            </paper-listbox>
                        </paper-dropdown-menu>
                    </div>
                </div>
            </paper-card>

            
            <steem-set-websocket-url websocket-url="[[settings.network.websocketUrl]]">
            </steem-set-websocket-url>

            <paper-card>
                <h2>Network</h2>
                <div class="card-content">

                    <paper-dropdown-menu label="Network">
                        <paper-listbox class="dropdown-content" selected="{{settings.network.chainName}}" attr-for-selected="value">
                            <paper-item value="steem">Steem</paper-item>
                            <paper-item value="golos">Golos</paper-item>
                        </paper-listbox>
                    </paper-dropdown-menu>

                    <div hidden="[[!_isChain(steem)]]">
                        <paper-dropdown-menu label="Steem node">
                            <paper-listbox class="dropdown-content" selected="{{settings.network.websocketUrl}}" attr-for-selected="value">

                                <template is="dom-repeat" items="[[settings.steem.defaultWebsocketUrls]]">
                                    <paper-item value="[[item]]">[[item]]</paper-item>
                                </template>
                                <template is="dom-repeat" items="[[settings.steem.customWebsocketUrls]]">
                                    <paper-item value="[[item]]">[[item]]</paper-item>
                                </template>

                            </paper-listbox>
                        </paper-dropdown-menu>
                    </div>

                    <div hidden="[[!_isChain(steem)]]">
                        <p>
                            <a href="https://status.steemnodes.com" target="_blank">https://status.steemnodes.com</a>
                        </p>
                    </div>

                    <div hidden="[[!_isChain(golos)]]">
                        <paper-dropdown-menu label="Golos node">
                            <paper-listbox class="dropdown-content" selected="{{settings.network.websocketUrl}}" attr-for-selected="value">

                                <template is="dom-repeat" items="[[settings.golos.defaultWebsocketUrls]]">
                                    <paper-item value="[[item]]">[[item]]</paper-item>
                                </template>
                                <template is="dom-repeat" items="[[settings.golos.customWebsocketUrls]]">
                                    <paper-item value="[[item]]">[[item]]</paper-item>
                                </template>

                            </paper-listbox>
                        </paper-dropdown-menu>
                    </div>
                </div>
            </paper-card>

            <paper-button id="resetSettingsButton" on-tap="_resetSettings()">
                Reset settings
            </paper-button>

        </div>

    </template>
</dom-module>

<script>Polymer({is:"page-settings",properties:{settings:{type:Object,notify:!0},_primaryColor:{type:String,observer:"_themeChanged"},_primaryTextColor:{type:String},_secondaryColor:{type:String,observer:"_themeChanged"},_secondaryTextColor:{type:String},_darkBackground:{type:Boolean,observer:"_darkBackgroundChanged"},_isReady:{type:Boolean,value:!1}},ready:function(){this.$.toggleDrawerMenu.addEventListener("tap",this._openDrawer.bind(this)),this.$.resetSettingsButton.addEventListener("tap",this._resetSettings.bind(this)),this._primaryColor=this.settings.theme.primaryColor,this._secondaryColor=this.settings.theme.secondaryColor||"#E91E63",this._primaryTextColor=this.settings.theme.primaryTextColor,this._secondaryTextColor=this.settings.theme.secondaryTextColor,this._isReady=!0,this._darkBackground="#282828"==this.settings.theme.primaryBackgroundColor},_openDrawer:function(){document.getElementById("appshell")._openDrawer()},_isChain:function(t){return t==this.settings.network.chainName.toLowerCase()},_resetSettings:function(){var t=document.getElementById("appshell");t.setDefaultSettings(),t.showToast("Setting successfully reset")},_darkBackgroundChanged:function(){this._isReady&&(this._darkBackground?(this.set("settings.theme.primaryBackgroundColor","#282828"),this.set("settings.theme.secondaryBackgroundColor","#383838"),this.set("settings.theme.backgroundPrimaryTextColor","#dddddd"),this.set("settings.theme.backgroundSecondaryTextColor","#888888")):(this.set("settings.theme.primaryBackgroundColor","#eeeeee"),this.set("settings.theme.secondaryBackgroundColor","#ffffff"),this.set("settings.theme.backgroundPrimaryTextColor","#282828"),this.set("settings.theme.backgroundSecondaryTextColor","#666666")))},_themeChanged:function(){"undefined"!=typeof this._primaryColor&&"undefined"!=typeof this._secondaryColor&&(this.set("settings.theme.primaryColor",this._primaryColor),this.set("settings.theme.secondaryColor",this._secondaryColor),this.set("settings.theme.ultraDarkPrimaryColor",this._getColorluminance(this._primaryColor,-.5)),this.set("settings.theme.darkPrimaryColor",this._getColorluminance(this._primaryColor,-.2)),this.set("settings.theme.lightPrimaryColor",this._getColorluminance(this._primaryColor,.2)),this._primaryTextColor=this._getTextColor(this._primaryColor),this._secondaryTextColor=this._getTextColor(this._secondaryColor),this.set("settings.theme.primaryTextColor",this._primaryTextColor),this.set("settings.theme.secondaryTextColor",this._secondaryTextColor))},_getColorluminance:function(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var r,s,o="#";for(s=0;s<3;s++)r=parseInt(t.substr(2*s,2),16),r=Math.round(Math.min(Math.max(0,r+r*e),255)).toString(16),o+=("00"+r).substr(r.length);return o},_getTextColor:function(t){var e=t.substr(1),r=parseInt(e.substr(0,2),16),s=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16),i=(299*r+587*s+114*o)/1e3;return i>=148?"#111111":"#eeeeee"}});</script></body></html>