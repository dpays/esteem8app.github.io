<html><head><link rel="import" href="../polymer/polymer.html">




<script src="../qrjs/qr.js"></script>

</head><body><dom-module is="granite-qrcode-generator">

    <template>
      <style>
        :host {
          display: block;
        }
      </style>
      <div id="qrCodeContainer"></div>
    </template>


    <script>Polymer({is:"granite-qrcode-generator",properties:{data:{type:String},format:{type:String,value:"html"},modulesize:{type:Number,value:5},margin:{type:Number,value:4},version:{type:Number,value:-1},mode:{type:String,value:"numeric"},ecclevel:{type:String,value:"L"},mask:{type:Number,value:-1},auto:{type:Boolean,value:!1}},observers:["paramsChanged(data,version,mode,ecclevel,mask,auto)"],paramsChanged:function(){console.debug("[granite-qrcode-generator] paramsChanged - auto ",this.auto),this.auto&&this.generateQRCode()},generateQRCode:function(){if(this._validateParams()){var e={modulesize:this.modulesize,margin:this.margin,version:this.version,mode:this.mode,ecclevel:this.ecclevel,mask:this.mask};"png"===this.format?this.generateQRCodePNG(e):this.generateQRCodeHTML(e)}},generateQRCodePNG:function(e){var a;try{a=document.createElement("img"),a.src=QRCode.generatePNG(this.data,e),this._qrCodeContainerAdd(a)}catch(e){console.log("no canvas support")}},generateQRCodeHTML:function(e){console.debug("[granite-qrcode-generator] generateQRCodeHTML - data ",this.data);var a=QRCode.generateHTML(this.data,e);this._appendQRCode(a)},_appendQRCode:function(e){for(var a=Polymer.dom(this.$.qrCodeContainer).children.length-1;a>=0;a--)Polymer.dom(this.$.qrCodeContainer).removeChild(Polymer.dom(this.$.qrCodeContainer).children[a]);Polymer.dom(this.$.qrCodeContainer).appendChild(e)},_validateParams:function(){return this._validateModulesize()&&this._validateVersion()&&this._validateMode()&&this._validateMask()&&this._validateEcclevel()},_validateModulesize:function(){return this.modulesize>=.5||(console.error("[granite-qrcode-generator] _validateModulesize - Invalid value of `modulesize`",this.modulesize),!1)},_validateMargin:function(){return this.margin>=-1||(console.error("[granite-qrcode-generator] _validateMargin - Invalid value of `margin`",this.margin),!1)},_validateVersion:function(){return this.version==-1||this.version>=0&&this.version<=40||(console.error("[granite-qrcode-generator] _validateVersion - Invalid value of `version`",this.version),!1)},_validateMode:function(){return"numeric"===this.mode||"alphanumeric"===this.mode||"octet"===this.mode||(console.error("[granite-qrcode-generator] _validateMode - Invalid value of `mode`",this.mode),!1)},_validateEcclevel:function(){return"L"===this.ecclevel||"M"===this.ecclevel||"Q"===this.ecclevel||"H"===this.ecclevel||(console.error("[granite-qrcode-generator] _validateEcclevel - Invalid value of `ecclevel`",this.ecclevel),!1)},_validateMask:function(){return this.mask>=-1&&this.mask<=7||(console.error("[granite-qrcode-generator] _validateMask - Invalid value of `mask`",this.mask),!1)}});</script>

</dom-module></body></html>