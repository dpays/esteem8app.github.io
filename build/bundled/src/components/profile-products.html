<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<link rel="import" href="../components/product-card.html">

<link rel="import" href="../dialogs/view-product-dialog.html">

<link rel="import" href="../shared-styles.html">

</head><body><dom-module id="profile-products">

    <template>

        <style include="shared-styles">

            /* GENERAL */
            :host{

            }

            #viewProductDialog {
                padding: 16px;
            }

        </style>

        

        
        <paper-dialog id="viewProductDialog" class="bigDialog" entry-animation="fade-in-animation" exit-animation="fade-out-animation" with-backdrop="">

            <h2>[[_product.name]]</h2>

            <product-content product="[[_product]]"></product-content>

        </paper-dialog>

        <div id="category-list">

            <paper-button id="resetProductQueryButton" on-tap="_resetProductQuery()" hidden="[[!categories.length]]">
                all
            </paper-button>

            <template is="dom-repeat" items="[[categories]]">
                <paper-button on-tap="_setProductQuery()">
                    [[item.name]]
                </paper-button>
            </template>

        </div>

        <div id="product-list">

            <template is="dom-repeat" items="[[products]]" filter="{{_getProductsFilter(_productQuery)}}">
                <product-card product="[[item]]" action="{{_actionProduct}}" allow-select="false">
                </product-card>
            </template>

        </div>

    </template>
</dom-module>

<script>Polymer({is:"profile-products",properties:{products:{type:Array},categories:{type:Array},_product:{type:Object},_productQuery:{type:String}},listeners:{"category-list.tap":"_setProductQuery"},observers:["_doAction(_actionProduct.type, _actionProduct.id)"],ready:function(){this.$.resetProductQueryButton.addEventListener("tap",this._resetProductQuery.bind(this))},_doAction:function(t,e){switch(t){case"view":this._openViewProduct(e)}},_setProductQuery:function(t){this._productQuery=t.model.item.name},_resetProductQuery:function(){this._productQuery=""},_openViewProduct:function(t){for(var e=0;e<this.products.length;e++)this.products[e].id==t&&(this.set("_product",this.products[e]),this.$.viewProductDialog.open())},_getProductsFilter:function(t){return t?(t=t.toLowerCase(),function(e){var r=[],o=!1,i=t.split(" ");"undefined"!=typeof e.tags&&(r=e.tags);for(var u=0;u<i.length;u++){for(var s=i[u].toLowerCase(),c=!1,n=0;n<r.length;n++){var d=r[n].toLowerCase();d==s&&(c=!0)}o=c}return o}):null}});</script></body></html>